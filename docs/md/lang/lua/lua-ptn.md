
# ptn


## ref

- https://ocraviutl.fandom.com/ja/wiki/Lua標準ライブラリ/文字列ライブラリ#Luaパターン


## basic

lua pattern は 正規表現とは違っており, かなり特殊です


```
エスケープ文字 は %
  たいていの正規表現 で \ の役割のもの

or 条件 | は ありません

パターンには途中にゼロ ( ASCII NUL, \0 ) を含むことができない
  代わりに `%z` を使う

```


## 文字クラス

```
.     すべての文字
        改行コード も含む

%a    英文字         
%c    制御文字       
%d    数字           
%l    英文字の小文字 
%p    区切り記号     
%s    空白文字       
%u    英文字の大文字 
%w    英数文字       
%x    16進数 で使われる文字
%z    0 byte 文字 ( `NUL` `0` )

%A    %a 以外
%C    %c 以外
%D    %d 以外
%L    %l 以外
%P    %p 以外
%S    %s 以外
%U    %u 以外
%W    %w 以外
%X    %x 以外
%Z    %z 以外

%     pattern で用いられる記号 自体 を表したいときのエスケープ文字
        ^$()%.[]*+-? など
      ex
        %%  %
        %.  .
        など

[set]  set 内に記述した それぞれの文字
         - を対象に入れるときは, 最後に記述
           or %-  ( 要確認 )
         ] を対象に入れるときは, 最初に記述        ( [ の直後 )
           or %]  ( 要確認 )
         ^ を対象に入れるときは, 2文字目以降に記述 ( [ の直後 以外 )
           or %^  ( 要確認 )

       特殊な表現
         最初 ( [ の直後 ) に ^ を書くと 指定以外の文字
         文字を - でつなぐ と 範囲指定
           つなぐ文字は 同じ種類の文字 であること
             数字, 英大文字, 英小文字

         set には 文字クラス も使用可

       ex
         [^abcd]    abcd 以外の文字
         [%w_]      英数文字 と _
         [0-7]      0 ~ 7 の数字 ( 8進数 で使われる文字 ) 
         [0-7%l%-]  0 ~ 7 の数字 と 英文字の小文字 と -
```


## 量指定子

```
*   直前の文字クラス の 0回以上の繰り返し にマッチする
    最長マッチ

+   直前の文字クラス の 1回以上の繰り返し にマッチする
    最長マッチ

-   直前の文字クラス の 0回以上の繰り返し にマッチする
    最短マッチ

?   直前の文字クラス の 0回 または 1回 にマッチする

%n  n : 1 - 9
    n 番目 にキャプチャされた文字列にマッチする要素 ( 要調査 )

%bxy
    x と y は異なる文字
    x で始まって y で終わる文字列にマッチ
    x と y は 数的に対応を取ったもの
      つまり,
      文字列を左から右に読んでいって,
      x が現れるたびに count を +1 し, y では -1 したとき,
      最初の x から count が 0 になる最初の y までの文字列
    ex
      %b()   カッコの対応が取れた式にマッチ

%f[set] ( frontier )
    set に含まれる文字が前にあり,
    set に含まれない文字が後ろにあるような位置にある空文字列とマッチ
    マッチ対象の先頭と末尾は文字 '\0' として処理される
    ( よく理解できないが, いったんあと回し )

```

注

```
{n, m} のようなものは ありません

グループ のようなものはなく, 
  よって, 量指定子 * + ? - もグループへの適用はない
  個々の文字 または 文字クラス にのみ適用されます
```


## pattern

pattern の要素は次のもの

```
^   パターンの先頭にある場合は, 文字列の先頭 を表す
    ( これはどういう意味なのか 要調査 )
    先頭以外の場所にある ^ は ^ そのもの

$   パターンの末尾にある場合は, 文字列の末尾 を表す
    ( これはどういう意味なのか 要調査 )
    末尾以外の場所にある $ は $ そのもの

文字クラス ( のみ)

文字クラス + 量指定子
```


