
# lua ptn


## basic

lua pattern は正規表現とは違っており, かなり特殊です

```
メタ文字にPerlなどの「\」ではなく、「%」を使う。
ドット(.)は改行コードもマッチ対象。

文字クラスの小文字と大文字の関係は補集合となる。
「複数の正規表現のいずれかにマッチ」する | は実装されていない。

量指定子（*、+、?、および- ）はグループを捕らえず、個々の文字または文字クラスにのみ適用できます。
-は0回以上の最短マッチ。(-は既存の正規表現でいうところの｢*?｣と思っておけばよいだろう。)
一般化された有限数量詞はありません（例えば、PCREの {n、 m} 数量詞）。

幅がゼロのアサーションは、^、$、および％f[set] "frontier"パターンのみです。
PCREの\bや(?=···)などのアサーションは存在しません。

パターン自体は '\''ddd'''のような文字エスケープを認識しません。
ただし、パターンはstringsなので、これらの種類のエスケープは、pattern-stringを作成するために使用される文字列リテラルで使用できます。
パターンには途中にゼロ(ASCII NUL、"\0")を含むことができない。代わりに%zを使う。
```


## 文字クラス

文字クラス は文字の集合を表すために使われます

文字クラスの記述では以下の組み合わせが使用できます

```
x (xはメタ文字(^$()%.[]*+-?)以外)
  文字xそれ自身を表す。

. (ドット)
  すべての文字を表す。

%x  (xは英数文字以外)
   文字x自身を表す、文字のエスケープ
   すべての句読点(メタでない文字も)は'%'を前置してパターン中でそれ自身を表すことができます

集合  補集合  集合の内容
%a  %A  すべてのletter
%c  %C  すべての制御文字
%d  %D  すべての数字
%l  %L  すべての小文字
%p  %P  すべての区切り記号
%s  %S  すべての空白文字
%u  %U  すべての大文字
%w  %W  すべての英数文字
%x  %X  すべての十六進数字
%z  %Z  NULや0として表現される0バイト文字
[set] [^set]  set内のすべての文字の和
      最初の文字と最後の文字をマイナス(-)でつなぐことで文字の範囲を指定することもできます
      set中の部品として上で説明した%xクラスもすべて使うことができますset中のそれ以外の文字はすべてそれ自身を表します
      例えば[%w_](または[_%w]) はすべての英数文字にアンダースコアを加えたものを表し、[0-7]は8進数字を表し、[0-7%l%-]は8進数字に小文字と'-'を加えたものを表します
      範囲を指定するときには、最初と最後の文字は同じ種類の文字(数字、英大文字、英小文字)でないといけません
      キャレット(^)を文字集合に含みたいときにはそれは先頭にあってはいけません
      閉じ角カッコ(])を集合に含む場合は、必ず最初の開き角カッコの直後におく必要があります
```


## パターンの要素

パターンの要素 は以下のいずれかである。

```
単一の文字クラス

単一の文字クラスに'*'が続いたもの
そのクラスの文字の0以上の繰り返しにマッチする
可能な限り長いシーケンスにマッチする

単一の文字クラスに'+'が続いたもの
そのクラスの文字の1以上の繰り返しにマッチする
可能な限り長いシーケンスにマッチする

単一の文字クラスに'-'が続いたもの
そのクラスの文字の0以上の繰り返しにマッチする
'*'と異なり、可能な限り短いシーケンスにマッチする


単一の文字クラスに'?'が続いたもの
そのクラスの文字の0回または1回の出現にマッチする

%n(nは1から9)
これは、n番目にキャプチャされた文字列にマッチするような要素である (下の説明を参照)

%bxy(xとyは異なる文字)
これはxで始まってyで終わる文字列にマッチするような要素である
xとyは対応が取れる
つまり、文字列を左から右に読んでいって、xが現れるたびにカウントを +1 し、yでは -1 したとき、最後のyはカウントが0になる最初のyである
例えば、要素%b()はカッコの対応が取れた式にマッチする

%f[set](境界パターン)
この項目は、次の文字がsetに属し前の文字がsetに属さない場所で、空文字列にマッチします
集合setは上で述べたように解釈されます
対象の先頭および末尾では、文字 '\0' が存在するかのように扱われます
```


ref : https://ocraviutl.fandom.com/ja/wiki/Lua標準ライブラリ/文字列ライブラリ#Luaパターン


